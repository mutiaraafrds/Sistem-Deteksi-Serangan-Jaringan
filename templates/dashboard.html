<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>IDS Professional Dashboard</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<nav class="navbar navbar-dark px-4">
    <span class="navbar-brand mb-0 h1">ðŸ›¡ Intrusion Detection System Dashboard</span>
</nav>

<div class="container mt-4">

    <!-- ALERT BANNER -->
    {% if threat_level != "LOW" %}
    <div class="alert alert-{{ threat_color }} text-center">
        ðŸš¨ Threat Level: <strong>{{ threat_level }}</strong>
        (Attack Traffic: {{ attack_percentage }}%)
    </div>
    {% endif %}

    <!-- THREAT STATUS CARD -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card p-4 text-center">
                <h4>Real-Time Threat Indicator</h4>
                <h1 class="text-{{ threat_color }}">
                    {{ threat_level }}
                </h1>

                <!-- Progress Bar -->
                <div class="progress mt-3" style="height: 30px;">
                    <div class="progress-bar bg-{{ threat_color }}"
                         role="progressbar"
                         style="width: {{ attack_percentage }}%;">
                        {{ attack_percentage }}% Attack Traffic
                    </div>
                </div>

            </div>
        </div>
    </div>

<div class="container mt-4">

    <!-- STAT CARDS -->
    <div class="row mb-4">

        <div class="col-md-4">
            <div class="card p-3 text-center">
                <h5>Total Traffic</h5>
                <h2>{{ result.values() | sum }}</h2>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card p-3 text-center">
                <h5>Model Accuracy</h5>
                <h2>{{ accuracy }}%</h2>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card p-3 text-center">
                <h5>Attack Ratio</h5>
                <h2>
                    {% if percentages %}
                        {{ (percentages.values() | list)[0] }}%
                    {% else %}
                        0%
                    {% endif %}
                </h2>
            </div>
        </div>

    </div>

    <!-- CHARTS -->
    <div class="row">
        <div class="col-md-6">
            <div class="card p-3">
                <h5>Traffic Distribution</h5>
                <canvas id="pieChart"></canvas>
            </div>
        </div>

        <div class="col-md-6">
            <div class="card p-3">
                <h5>Attack Breakdown</h5>
                <canvas id="barChart"></canvas>
            </div>
        </div>
    </div>

</div>

<script>
    const labels = {{ result.keys() | list | safe }};
    const values = {{ result.values() | list | safe }};

    new Chart(document.getElementById('pieChart'), {
        type: 'pie',
        data: {
            labels: labels,
            datasets: [{
                data: values
            }]
        }
    });

    new Chart(document.getElementById('barChart'), {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                data: values
            }]
        }
    });
</script>

</body>
</html>